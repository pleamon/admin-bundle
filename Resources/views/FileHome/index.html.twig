{% extends base_template %}

{% form_theme form 'bootstrap_3_layout.html.twig' %}

{% block content %}
<div class="row">
    <div class="col-lg-3">
        <div class="ibox float-e-margins">
            <div class="ibox-content">
                <div class="file-manager">
                    <h5>Show:</h5>
                    <a href="{{ path("p_file_home" )}}" class="file-control {% if type is empty %}active{% endif %}">All</a>
                    {% for name, _ in types %}
                    <a href="{{ path("p_file_home", {type: name} )}}" class="file-control {% if name == type %}active{% endif %}">{{ name }}</a>
                    {% endfor %}
                    <div class="hr-line-dashed"></div>
                    <button class="btn btn-primary btn-block" data-toggle="modal" data-target="#modal-upload">Upload Files</button>
                    <div class="hr-line-dashed"></div>
                    <h5>Folders</h5>
                    <ul class="folder-list" style="padding: 0">
                        {% for category in categories %}
                        <li><a href="{{ path("p_file_home", {category: category.id}) }}"><i class="fa fa-folder"></i> {{ category.name }}</a></li>
                        {% endfor %}
                    </ul>
                    <h5 class="tag-title">Tags</h5>
                    <ul class="tag-list" style="padding: 0">
                        {% for tag in tags %}
                        <li><a href="{{ path("p_file_home", {tag: tag.id}) }}">{{ tag.name }}</a></li>
                        {% endfor %}
                    </ul>
                    <div class="clearfix"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-9 animated fadeInRight">
        <div class="row">
            <div class="col-lg-12">
                {% for file in files %}
                    <div class="file-box">
                    <div class="file">
                        <a target="_blank" href="{{ path("p_file_download", {category: file.category.name, filename: file.filename }) }}">
                            <span class="corner"></span>

                            {% if file.suffix in ['jpg'] %}
                            <div class="image">
                                <img alt="image" class="img-responsive" src="{{ file.accessPath }}">
                            </div>
                            {% elseif file.suffix in ['mp3'] %}
                            <div class="icon">
                                <i class="fa fa-music"></i>
                            </div>
                            {% elseif file.suffix in ['xls', 'xlsx'] %}
                            <div class="icon">
                                <i class="fa fa-bar-chart-o"></i>
                            </div>
                            {% elseif file.suffix in ['mpg4'] %}
                            <div class="icon">
                                <i class="img-responsive fa fa-film"></i>
                            </div>
                            {% elseif file.suffix in ['doc', 'docx'] %}
                            <div class="icon">
                                <i class="fa fa-file"></i>
                            </div>
                            {% else %}
                            <div class="icon">
                                <i class="fa fa-file"></i>
                            </div>
                            {% endif %}
                            <div class="file-name">
                                {{ file.filename }}
                                <br>
                                <small>Added: {{ file.createdAt|date('Y-m-d H:i:s') }}</small>
                            </div>
                        </a>
                    </div>

                </div>

                {% endfor %}
            </div>
        </div>
        </div>
    </div>
    <div class="modal inmodal in" id="modal-upload" role="dialog" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content animated fadeIn">
                {{ form_start(form) }}
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
                    <i class="fa fa-cloud-upload modal-icon"></i>
                    <h4 class="modal-title">上传文件</h4>
                    <small></small>
                </div>
                <div class="modal-body">
                    {{ form_row(form.category) }}
                    {{ form_row(form.tags) }}
                    {{ form_row(form.file) }}
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-white" data-dismiss="modal">Close</button>
                    {{ form_widget(form.submit) }}
                </div>
                {{ form_end(form) }}
            </div>
        </div>
    </div>
{% endblock %}
