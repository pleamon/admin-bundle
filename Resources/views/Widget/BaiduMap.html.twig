{% extends 'PAdminBundle:layout:widget.html.twig' %}

{% block stylesheets %}
<style>
    #map_container_{{ widget.uniqid }} {
        min-height: 300px;
        height: 100%;
    }
</style>
{% endblock %}

{% block uniqid %}{{ widget.uniqid }}{% endblock %}

{% block ibox_title %} 全国地图 {% endblock %}

{% block ibox_tools %}
<a class="fullscreen-link">
    <i class="fa fa-arrows-alt"></i>
</a>
{% endblock %}

{% block ibox_content %}
<div class="ibox_content" id="map_container_{{ widget.uniqid }}">
</div>
{% endblock %}

{% block javascripts %}
<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=zU8Bw7tUN9LGIWrpeu1IL0au64wzOECx"></script>
<script type="text/javascript">
    // 百度地图API功能
    var map = new BMap.Map("map_container_{{ widget.uniqid }}");
	var point = new BMap.Point(116, 35);
	map.centerAndZoom(point, 5);
	// 编写自定义函数,创建标注
	function addMarker(point){
	}
    map.addControl(new BMap.NavigationControl());
    map.addControl(new BMap.ScaleControl());

    var geolocation = new BMap.Geolocation();
	geolocation.getCurrentPosition(function(r){
		if(this.getStatus() == BMAP_STATUS_SUCCESS){
			var mk = new BMap.Marker(r.point);
			map.addOverlay(mk);
			map.panTo(r.point);
		}
	},{enableHighAccuracy: true})
{#
var geo = new BMap.Geocoder();
{% for store in stores %}
    geo.getPoint("{{ store.address }}", function(point) {
        map.addOverlay(new BMap.Marker(point));
    }, "{{ store.region }}")
{% endfor %}
#}
</script>
{% endblock %}
